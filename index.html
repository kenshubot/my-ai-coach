<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI思考パートナー研修ツール</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=Noto+Sans+JP:wght@400;500;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Noto Sans JP', 'Inter', sans-serif;
        }
        .tab-active {
            border-color: #4f46e5;
            color: #4f46e5;
            background-color: #eef2ff;
        }
        .tab-inactive {
            border-color: transparent;
            color: #6b7280;
        }
        .ai-response p {
            margin-bottom: 1rem;
        }
        .ai-response ul {
            list-style-type: disc;
            margin-left: 1.5rem;
            margin-bottom: 1rem;
        }
        .ai-response ol {
            list-style-type: decimal;
            margin-left: 1.5rem;
            margin-bottom: 1rem;
        }
         .ai-response strong, .ai-response b {
            font-weight: 700;
            color: #1f2937;
        }
        .loader {
            border: 4px solid #f3f3f3;
            border-top: 4px solid #4f46e5;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
            margin: 2rem auto;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
    </style>
</head>
<body class="bg-gray-50 text-gray-800">

    <div class="container mx-auto p-4 sm:p-6 lg:p-8 max-w-4xl">
        <header class="text-center mb-8">
            <h1 class="text-3xl sm:text-4xl font-bold text-gray-900">AI思考パートナー研修ツール</h1>
            <p class="mt-2 text-lg text-gray-600">「最高の旅行プラン」で学ぶ！ロジカルシンキング</p>
        </header>

        <div class="bg-white rounded-xl shadow-lg">
            <!-- Tabs -->
            <div class="border-b border-gray-200">
                <nav class="flex -mb-px" aria-label="Tabs">
                    <button id="tab-1" class="tab-btn w-1/4 py-4 px-1 text-center border-b-2 font-medium text-sm sm:text-base tab-active" onclick="changeTab(1)">ステップ1: MECE</button>
                    <button id="tab-2" class="tab-btn w-1/4 py-4 px-1 text-center border-b-2 font-medium text-sm sm:text-base tab-inactive" onclick="changeTab(2)">ステップ2: ロジックツリー</button>
                    <button id="tab-3" class="tab-btn w-1/4 py-4 px-1 text-center border-b-2 font-medium text-sm sm:text-base tab-inactive" onclick="changeTab(3)">ステップ3: ピラミッド</button>
                    <button id="tab-4" class="tab-btn w-1/4 py-4 px-1 text-center border-b-2 font-medium text-sm sm:text-base tab-inactive" onclick="changeTab(4)">ステップ4: 仮説思考</button>
                </nav>
            </div>

            <!-- Tab Content -->
            <div id="content-1" class="p-6">
                <h2 class="text-xl font-bold mb-2">ステップ1: MECEで「忘れ物をゼロ」にする技術</h2>
                <p class="mb-4 text-gray-600">お題：「2泊3日の沖縄旅行！持ち物をMECEに分類しよう」。思いつく持ち物と、その分類を書き出してください。</p>
                <textarea id="input-1" class="w-full h-48 p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition" placeholder="例：&#10;【衣類】&#10;・Tシャツ 3枚&#10;・ズボン 2本&#10;【電子機器】&#10;・スマホ&#10;・充電器..."></textarea>
                <button onclick="getAIFeedback(1)" class="mt-4 w-full bg-indigo-600 text-white font-bold py-3 px-4 rounded-lg hover:bg-indigo-700 transition-colors flex items-center justify-center">
                    <svg class="w-5 h-5 mr-2" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M8.25 3v1.5M4.5 8.25H3v1.5h1.5V8.25Zm-1.5 4.5H3v1.5h1.5v-1.5Zm1.5-1.5H3v1.5h1.5v-1.5Zm1.5 1.5H6v1.5h1.5v-1.5Zm1.5-1.5H6v1.5h1.5v-1.5Zm1.5 1.5H9v1.5h1.5v-1.5Zm1.5-1.5H9v1.5h1.5v-1.5Zm1.5 1.5h1.5v1.5H12v-1.5Zm-1.5-1.5h1.5v1.5H12v-1.5Zm-1.5 1.5h1.5v1.5H12v-1.5Zm-1.5-1.5h1.5v1.5H12v-1.5Zm-1.5 1.5h1.5v1.5H12v-1.5Zm1.5-1.5h1.5v1.5H12v-1.5Zm1.5 1.5h1.5v1.5H12v-1.5Zm1.5-1.5h1.5v1.5H12v-1.5ZM16.5 8.25h1.5v1.5h-1.5V8.25Zm-1.5 4.5h1.5v1.5h-1.5v-1.5Zm1.5-1.5h1.5v1.5h-1.5v-1.5Zm1.5 1.5h1.5v1.5h-1.5v-1.5Zm-1.5-1.5h1.5v1.5h-1.5v-1.5Zm1.5 1.5h1.5v1.5h-1.5v-1.5Zm1.5-1.5h1.5v1.5h-1.5v-1.5Zm1.5 1.5v1.5h1.5v-1.5h-1.5Z" /><path stroke-linecap="round" stroke-linejoin="round" d="M3.001 6a2.25 2.25 0 0 1 2.25-2.25h13.5a2.25 2.25 0 0 1 2.25 2.25v1.5h-18v-1.5Zm18 3.75v9a2.25 2.25 0 0 1-2.25 2.25H5.251a2.25 2.25 0 0 1-2.25-2.25v-9h18Z" /></svg>
                    AIに相談する
                </button>
                <div id="output-1" class="mt-6"></div>
            </div>

            <div id="content-2" class="p-6 hidden">
                <h2 class="text-xl font-bold mb-2">ステップ2: ロジックツリーで「やりたいこと」を遊び尽くす技術</h2>
                <p class="mb-4 text-gray-600">お題：「予算5万円で、最高の週末旅行プランを考えよう」。なぜその場所に行きたいのか(Why)、どうやって楽しむのか(How)を書き出してください。</p>
                <textarea id="input-2" class="w-full h-48 p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition" placeholder="例：&#10;【Why? なぜ行きたいか】&#10;・とにかく癒やされたいから。&#10;・日常から離れてリフレッシュしたい。&#10;【How? どうやって】&#10;・景色の良い温泉に入る。&#10;・地元の美味しいものを食べる..."></textarea>
                <button onclick="getAIFeedback(2)" class="mt-4 w-full bg-indigo-600 text-white font-bold py-3 px-4 rounded-lg hover:bg-indigo-700 transition-colors flex items-center justify-center">
                    <svg class="w-5 h-5 mr-2" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M8.25 3v1.5M4.5 8.25H3v1.5h1.5V8.25Zm-1.5 4.5H3v1.5h1.5v-1.5Zm1.5-1.5H3v1.5h1.5v-1.5Zm1.5 1.5H6v1.5h1.5v-1.5Zm1.5-1.5H6v1.5h1.5v-1.5Zm1.5 1.5H9v1.5h1.5v-1.5Zm1.5-1.5H9v1.5h1.5v-1.5Zm1.5 1.5h1.5v1.5H12v-1.5Zm-1.5-1.5h1.5v1.5H12v-1.5Zm-1.5 1.5h1.5v1.5H12v-1.5Zm-1.5-1.5h1.5v1.5H12v-1.5Zm-1.5 1.5h1.5v1.5H12v-1.5Zm1.5-1.5h1.5v1.5H12v-1.5Zm1.5 1.5h1.5v1.5H12v-1.5Zm1.5-1.5h1.5v1.5H12v-1.5ZM16.5 8.25h1.5v1.5h-1.5V8.25Zm-1.5 4.5h1.5v1.5h-1.5v-1.5Zm1.5-1.5h1.5v1.5h-1.5v-1.5Zm1.5 1.5h1.5v1.5h-1.5v-1.5Zm-1.5-1.5h1.5v1.5h-1.5v-1.5Zm1.5 1.5h1.5v1.5h-1.5v-1.5Zm1.5-1.5h1.5v1.5h-1.5v-1.5Zm1.5 1.5v1.5h1.5v-1.5h-1.5Z" /><path stroke-linecap="round" stroke-linejoin="round" d="M3.001 6a2.25 2.25 0 0 1 2.25-2.25h13.5a2.25 2.25 0 0 1 2.25 2.25v1.5h-18v-1.5Zm18 3.75v9a2.25 2.25 0 0 1-2.25 2.25H5.251a2.25 2.25 0 0 1-2.25-2.25v-9h18Z" /></svg>
                    AIに相談する
                </button>
                <div id="output-2" class="mt-6"></div>
            </div>
            
            <div id="content-3" class="p-6 hidden">
                <h2 class="text-xl font-bold mb-2">ステップ3: ピラミッド構造で「行きたい場所」へ連れて行く技術</h2>
                <p class="mb-4 text-gray-600">お題：「乗り気じゃない友人を、あなたが考えた週末旅行に誘ってみよう」。友人への誘い文句を書いてください。</p>
                <textarea id="input-3" class="w-full h-48 p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition" placeholder="例：&#10;「ねえ、今度の週末京都に行かない？&#10;君が好きそうなカフェを見つけたんだ。抹茶のスイーツが美味しいらしいよ。&#10;近くには雑貨屋さんもあって、二人とも楽しめると思うんだ。」"></textarea>
                <button onclick="getAIFeedback(3)" class="mt-4 w-full bg-indigo-600 text-white font-bold py-3 px-4 rounded-lg hover:bg-indigo-700 transition-colors flex items-center justify-center">
                    <svg class="w-5 h-5 mr-2" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M8.25 3v1.5M4.5 8.25H3v1.5h1.5V8.25Zm-1.5 4.5H3v1.5h1.5v-1.5Zm1.5-1.5H3v1.5h1.5v-1.5Zm1.5 1.5H6v1.5h1.5v-1.5Zm1.5-1.5H6v1.5h1.5v-1.5Zm1.5 1.5H9v1.5h1.5v-1.5Zm1.5-1.5H9v1.5h1.5v-1.5Zm1.5 1.5h1.5v1.5H12v-1.5Zm-1.5-1.5h1.5v1.5H12v-1.5Zm-1.5 1.5h1.5v1.5H12v-1.5Zm-1.5-1.5h1.5v1.5H12v-1.5Zm-1.5 1.5h1.5v1.5H12v-1.5Zm1.5-1.5h1.5v1.5H12v-1.5Zm1.5 1.5h1.5v1.5H12v-1.5Zm1.5-1.5h1.5v1.5H12v-1.5ZM16.5 8.25h1.5v1.5h-1.5V8.25Zm-1.5 4.5h1.5v1.5h-1.5v-1.5Zm1.5-1.5h1.5v1.5h-1.5v-1.5Zm1.5 1.5h1.5v1.5h-1.5v-1.5Zm-1.5-1.5h1.5v1.5h-1.5v-1.5Zm1.5 1.5h1.5v1.5h-1.5v-1.5Zm1.5-1.5h1.5v1.5h-1.5v-1.5Zm1.5 1.5v1.5h1.5v-1.5h-1.5Z" /><path stroke-linecap="round" stroke-linejoin="round" d="M3.001 6a2.25 2.25 0 0 1 2.25-2.25h13.5a2.25 2.25 0 0 1 2.25 2.25v1.5h-18v-1.5Zm18 3.75v9a2.25 2.25 0 0 1-2.25 2.25H5.251a2.25 2.25 0 0 1-2.25-2.25v-9h18Z" /></svg>
                    AIに相談する
                </button>
                <div id="output-3" class="mt-6"></div>
            </div>

            <div id="content-4" class="p-6 hidden">
                <h2 class="text-xl font-bold mb-2">ステップ4: 仮説思考で「予期せぬトラブル」を楽しむ技術</h2>
                <p class="mb-4 text-gray-600">お題：「楽しみにしていた野外フェス。当日、天気予報は1日中大雨。さあ、どうする？」あなたの対応策を複数考えてみてください。</p>
                <textarea id="input-4" class="w-full h-48 p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition" placeholder="例：&#10;仮説A：完全防水の装備で臨む。&#10;仮説B：近くの別の観光地に切り替える。&#10;仮説C：好きなアーティストの時間だけ行く..."></textarea>
                <button onclick="getAIFeedback(4)" class="mt-4 w-full bg-indigo-600 text-white font-bold py-3 px-4 rounded-lg hover:bg-indigo-700 transition-colors flex items-center justify-center">
                    <svg class="w-5 h-5 mr-2" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M8.25 3v1.5M4.5 8.25H3v1.5h1.5V8.25Zm-1.5 4.5H3v1.5h1.5v-1.5Zm1.5-1.5H3v1.5h1.5v-1.5Zm1.5 1.5H6v1.5h1.5v-1.5Zm1.5-1.5H6v1.5h1.5v-1.5Zm1.5 1.5H9v1.5h1.5v-1.5Zm1.5-1.5H9v1.5h1.5v-1.5Zm1.5 1.5h1.5v1.5H12v-1.5Zm-1.5-1.5h1.5v1.5H12v-1.5Zm-1.5 1.5h1.5v1.5H12v-1.5Zm-1.5-1.5h1.5v1.5H12v-1.5Zm-1.5 1.5h1.5v1.5H12v-1.5Zm1.5-1.5h1.5v1.5H12v-1.5Zm1.5 1.5h1.5v1.5H12v-1.5Zm1.5-1.5h1.5v1.5H12v-1.5ZM16.5 8.25h1.5v1.5h-1.5V8.25Zm-1.5 4.5h1.5v1.5h-1.5v-1.5Zm1.5-1.5h1.5v1.5h-1.5v-1.5Zm1.5 1.5h1.5v1.5h-1.5v-1.5Zm-1.5-1.5h1.5v1.5h-1.5v-1.5Zm1.5 1.5h1.5v1.5h-1.5v-1.5Zm1.5-1.5h1.5v1.5h-1.5v-1.5Zm1.5 1.5v1.5h1.5v-1.5h-1.5Z" /><path stroke-linecap="round" stroke-linejoin="round" d="M3.001 6a2.25 2.25 0 0 1 2.25-2.25h13.5a2.25 2.25 0 0 1 2.25 2.25v1.5h-18v-1.5Zm18 3.75v9a2.25 2.25 0 0 1-2.25 2.25H5.251a2.25 2.25 0 0 1-2.25-2.25v-9h18Z" /></svg>
                    AIに相談する
                </button>
                <div id="output-4" class="mt-6"></div>
            </div>
        </div>
    </div>

    <script>
        // タブ切り替え機能
        function changeTab(tabIndex) {
            const tabs = document.querySelectorAll('.tab-btn');
            const contents = document.querySelectorAll('[id^="content-"]');
            
            tabs.forEach(tab => {
                tab.classList.remove('tab-active');
                tab.classList.add('tab-inactive');
            });
            contents.forEach(content => {
                content.classList.add('hidden');
            });

            document.getElementById(`tab-${tabIndex}`).classList.add('tab-active');
            document.getElementById(`tab-${tabIndex}`).classList.remove('tab-inactive');
            document.getElementById(`content-${tabIndex}`).classList.remove('hidden');
        }

        // AIからのフィードバックを取得するメイン機能
        async function getAIFeedback(step) {
            const userInput = document.getElementById(`input-${step}`).value;
            const outputDiv = document.getElementById(`output-${step}`);

            if (!userInput.trim()) {
                outputDiv.innerHTML = `<div class="p-4 bg-yellow-100 text-yellow-800 border-l-4 border-yellow-500 rounded-r-lg">回答を入力してください。</div>`;
                return;
            }

            outputDiv.innerHTML = '<div class="loader"></div>';

            const basePrompt = "あなたは、ロジカルシンキングを教えるプロの講師です。受講者の思考を深めるために、丁寧かつ的確なフィードバックをしてください。ポジティブな点を認めつつ、改善点を具体的に指摘し、より良い思考のためのヒントや質問を投げかける形で応答してください。";
            let stepPrompt = "";

            switch(step) {
                case 1:
                    stepPrompt = `以下の持ち物リストがMECE（モレなく、ダブりなく）になっているか評価してください。「モレ」の観点（他にどんな持ち物が必要そうか）と、「ダブり」の観点（まとめられるものはないか）を指摘してください。また、より優れた分類の「切り口」があれば提案してください。`;
                    break;
                case 2:
                    stepPrompt = `以下の旅行プランについて、ロジックツリーの観点からフィードバックしてください。「Why（なぜそこに行きたいのか）」が十分に深掘りできているか、そして「How（どうやって楽しむか）」が具体的になっているかを確認し、思考をさらに深めるための質問を投げかけてください。`;
                    break;
                case 3:
                    stepPrompt = `以下の「友人への誘い文句」を、ピラミッド構造の観点から評価してください。「結論（何をしたいか）」が明確か、その「根拠」として相手のメリットや共通の楽しみが示されているか、実現可能性に触れられているかなどを分析し、より説得力のある伝え方をアドバイスしてください。`;
                    break;
                case 4:
                    stepPrompt = `以下の「トラブルへの対応策」について、仮説思考の観点からレビューしてください。複数の仮説を立てられているか、それぞれの仮説のメリット・デメリットを考慮できているか、意思決定のための判断軸は何か、などを問いかけ、より良いリスク管理と意思決定ができるように導いてください。`;
                    break;
            }

            const fullPrompt = `${basePrompt}\n\n${stepPrompt}\n\n# 受講者の回答\n${userInput}`;
            
            try {
                let chatHistory = [];
                chatHistory.push({ role: "user", parts: [{ text: fullPrompt }] });
                const payload = { contents: chatHistory };
                const apiKey = "" // If you want to use models other than gemini-2.5-flash-preview-05-20 or imagen-3.0-generate-002, provide an API key here. Otherwise, leave this as-is.
                const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-05-20:generateContent?key=${apiKey}`;
                
                const response = await fetch(apiUrl, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(payload)
                });

                if (!response.ok) {
                    throw new Error(`APIエラー: ${response.status} ${response.statusText}`);
                }

                const result = await response.json();
                
                if (result.candidates && result.candidates.length > 0 &&
                    result.candidates[0].content && result.candidates[0].content.parts &&
                    result.candidates[0].content.parts.length > 0) {
                    let text = result.candidates[0].content.parts[0].text;
                    // 簡単なマークダウンをHTMLに変換
                    text = text.replace(/\*\*(.*?)\*\*/g, '<strong>$1</strong>');
                    text = text.replace(/\n/g, '<br>');
                    outputDiv.innerHTML = `<div class="p-4 bg-indigo-50 border-l-4 border-indigo-500 rounded-r-lg ai-response">${text}</div>`;
                } else {
                     outputDiv.innerHTML = `<div class="p-4 bg-red-100 text-red-800 border-l-4 border-red-500 rounded-r-lg">AIからの有効な応答がありませんでした。もう一度試してください。</div>`;
                }

            } catch (error) {
                console.error("Error:", error);
                outputDiv.innerHTML = `<div class="p-4 bg-red-100 text-red-800 border-l-4 border-red-500 rounded-r-lg">エラーが発生しました。時間をおいてもう一度お試しください。</div>`;
            }
        }
    </script>
</body>
</html>

